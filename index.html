<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Backtest Tracker</title>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-firestore-compat.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
    }
    input, select, button {
      display: block;
      margin: 10px 0;
      padding: 8px;
      width: 100%;
    }
    .readonly-field {
      background: #f0f0f0;
      padding: 8px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
    }
  </style>
</head>
<body>
  <h1>Backtest Tracker</h1><button id="googleSignIn">Sign in with Google</button>

  <div id="formSection" style="display: none;">
    <select id="pair">
      <option value="">Select Pair</option>
      <option value="EURUSD">EURUSD</option>
      <option value="EURCAD">EURCAD</option>
      <option value="GBPUSD">GBPUSD</option>
      <option value="US30">US30</option>
      <option value="BTCUSD">BTCUSD</option>
    </select>
    <input type="datetime-local" id="date" />
    <input type="text" id="h4Dir" placeholder="H4 Direction" />
    <input type="text" id="h1Dir" placeholder="H1 Direction" />
    <input type="text" id="zone" placeholder="Zone (H1/15m)" />
    <input type="number" step="0.01" id="entry" placeholder="Entry Price" />
    <input type="number" step="0.01" id="sl" placeholder="Stop Loss" />
    <input type="number" step="0.01" id="tp" placeholder="Take Profit" /><div>
  <label>SL Size:</label>
  <div id="slSizeDisplay" class="readonly-field">0</div>
</div>
<div>
  <label>Risk to Reward:</label>
  <div id="rrDisplay" class="readonly-field">0</div>
</div>

<input type="text" id="notes" placeholder="Notes" />
<select id="result">
  <option value="">Select Result</option>
  <option value="win">Win</option>
  <option value="loss">Loss</option>
  <option value="BE">Break Even</option>
</select>
<button id="saveBtn">Save Trade</button>

  </div>  <script>
    const firebaseConfig = {
      apiKey: "AIzaSyBwyR0ZKURFDUHYOmA8_i1-cZh0hH2bAS8",
      authDomain: "backtest-dashboard-a4e22.firebaseapp.com",
      projectId: "backtest-dashboard-a4e22",
      storageBucket: "backtest-dashboard-a4e22.appspot.com",
      messagingSenderId: "311553062691",
      appId: "1:311553062691:web:daba5ade180a89d131be96",
      measurementId: "G-86YMM5RRCD"
    };

    firebase.initializeApp(firebaseConfig);
    const auth = firebase.auth();
    const db = firebase.firestore();

    const signInBtn = document.getElementById('googleSignIn');
    const saveBtn = document.getElementById('saveBtn');
    const formSection = document.getElementById('formSection');

    signInBtn.onclick = () => {
      const provider = new firebase.auth.GoogleAuthProvider();
      auth.signInWithPopup(provider)
        .then(() => {
          formSection.style.display = 'block';
          signInBtn.style.display = 'none';
        })
        .catch(err => alert(err.message));
    };

    saveBtn.onclick = async () => {
      const trade = {
        pair: document.getElementById('pair').value,
        date: document.getElementById('date').value,
        h4Dir: document.getElementById('h4Dir').value,
        h1Dir: document.getElementById('h1Dir').value,
        zone: document.getElementById('zone').value,
        entry: parseFloat(document.getElementById('entry').value),
        sl: parseFloat(document.getElementById('sl').value),
        tp: parseFloat(document.getElementById('tp').value),
        notes: document.getElementById('notes').value,
        result: document.getElementById('result').value,
        slSize: parseFloat(document.getElementById('slSizeDisplay').textContent),
        rr: parseFloat(document.getElementById('rrDisplay').textContent),
        uid: auth.currentUser.uid
      };

      try {
        await db.collection('backtests').add(trade);
        alert('Trade saved!');
      } catch (e) {
        alert('Error saving trade: ' + e.message);
      }
    };

    ['entry', 'sl', 'tp'].forEach(id => {
      document.getElementById(id).addEventListener('input', calculateStats);
    });

    function calculateStats() {
      const entry = parseFloat(document.getElementById('entry').value);
      const sl = parseFloat(document.getElementById('sl').value);
      const tp = parseFloat(document.getElementById('tp').value);

      if (!isNaN(entry) && !isNaN(sl) && !isNaN(tp)) {
        const slSize = Math.abs(entry - sl);
        const rr = Math.abs(tp - entry) / slSize;

        document.getElementById('slSizeDisplay').textContent = slSize.toFixed(2);
        document.getElementById('rrDisplay').textContent = rr.toFixed(2);
      }
    }
  </script></body>
</html>
