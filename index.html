<!DOCTYPE html><html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Backtest Dashboard</title>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0;
      padding: 1rem;
      background: #f5f7fa;
    }
    h2 {
      text-align: center;
    }
    .card {
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0,0,0,0.1);
      padding: 1rem;
      margin-bottom: 1rem;
    }
    .form-group, .stats-controls {
      margin-bottom: 1rem;
    }
    input, select, button {
      padding: 0.5rem;
      border-radius: 4px;
      border: 1px solid #ccc;
      width: 100%;
    }
    button {
      background-color: #007bff;
      color: white;
      border: none;
      cursor: pointer;
    }
    button:hover {
      background-color: #0056b3;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 1rem;
    }
    th, td {
      padding: 0.5rem;
      border: 1px solid #ccc;
      text-align: left;
    }
  </style>
</head>
<body>
  <h2>Backtest Dashboard</h2>
  <div class="card">
    <div class="form-group">
      <label>Pair:</label>
      <select id="pair">
        <option>EURUSD</option>
        <option>EURCAD</option>
        <option>GBPUSD</option>
        <option>US30</option>
        <option>BTCUSD</option>
      </select>
    </div>
    <div class="form-group">
      <label>Date:</label>
      <input type="date" id="date" />
    </div>
    <div class="form-group">
      <label>H4 Direction:</label>
      <select id="h4Direction">
        <option>Bullish</option>
        <option>Bearish</option>
      </select>
    </div>
    <div class="form-group">
      <label>H1 Direction:</label>
      <select id="h1Direction">
        <option>Bullish</option>
        <option>Bearish</option>
      </select>
    </div>
    <div class="form-group">
      <label>Zone Type:</label>
      <select id="zoneType">
        <option>Supply</option>
        <option>Demand</option>
      </select>
    </div>
    <div class="form-group">
      <label>Entry Price:</label>
      <input type="number" id="entryPrice" step="0.0001" />
    </div>
    <div class="form-group">
      <label>Stop Loss:</label>
      <input type="number" id="stopLoss" step="0.0001" />
    </div>
    <div class="form-group">
      <label>Take Profit:</label>
      <input type="number" id="takeProfit" step="0.0001" />
    </div>
    <div class="form-group">
      <label>Result:</label>
      <select id="result">
        <option>Win</option>
        <option>Loss</option>
      </select>
    </div>
    <button onclick="saveTrade()">Save Trade</button>
    <input type="file" id="importFile" accept=".csv">
    <button onclick="importTrades()">Import Trade Data</button>
    <button onclick="exportTrades()">Export Trade Data as CSV</button>
  </div>  <div class="card">
    <h3>Trade Table</h3>
    <table id="tradeTable">
      <thead>
        <tr>
          <th>Pair</th>
          <th>Date</th>
          <th>H4</th>
          <th>H1</th>
          <th>Zone</th>
          <th>Entry</th>
          <th>SL</th>
          <th>TP</th>
          <th>Result</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </div>  <div class="card">
    <h3>Monthly Statistics</h3>
    <div class="form-group">
      <label>Select Pair:</label>
      <select id="statsPairSelect" onchange="generateStats()">
        <option value="EURUSD">EURUSD</option>
        <option value="EURCAD">EURCAD</option>
        <option value="GBPUSD">GBPUSD</option>
        <option value="US30">US30</option>
        <option value="BTCUSD">BTCUSD</option>
      </select>
    </div>
    <div id="statsContainer"></div>
    <canvas id="chartCanvas" width="400" height="200"></canvas>
  </div>  <script>
    let trades = JSON.parse(localStorage.getItem("trades") || "[]");

    function saveTrade() {
      const trade = {
        pair: document.getElementById("pair").value,
        date: document.getElementById("date").value,
        h4: document.getElementById("h4Direction").value,
        h1: document.getElementById("h1Direction").value,
        zone: document.getElementById("zoneType").value,
        entry: parseFloat(document.getElementById("entryPrice").value),
        sl: parseFloat(document.getElementById("stopLoss").value),
        tp: parseFloat(document.getElementById("takeProfit").value),
        result: document.getElementById("result").value,
      };
      trades.push(trade);
      localStorage.setItem("trades", JSON.stringify(trades));
      renderTable();
      generateStats();
    }

    function renderTable() {
      const tbody = document.querySelector("#tradeTable tbody");
      tbody.innerHTML = trades.map(t => `
        <tr>
          <td>${t.pair}</td>
          <td>${t.date}</td>
          <td>${t.h4}</td>
          <td>${t.h1}</td>
          <td>${t.zone}</td>
          <td>${t.entry}</td>
          <td>${t.sl}</td>
          <td>${t.tp}</td>
          <td>${t.result}</td>
        </tr>
      `).join("");
    }

    function exportTrades() {
      let csv = "Pair,Date,H4,H1,Zone,Entry,SL,TP,Result\n";
      trades.forEach(t => {
        csv += `${t.pair},${t.date},${t.h4},${t.h1},${t.zone},${t.entry},${t.sl},${t.tp},${t.result}\n`;
      });
      const blob = new Blob([csv], { type: "text/csv" });
      const url = URL.createObjectURL(blob);
      const a = document.createElement("a");
      a.href = url;
      a.download = "trades.csv";
      a.click();
    }

    function importTrades() {
      const file = document.getElementById("importFile").files[0];
      const reader = new FileReader();
      reader.onload = e => {
        const rows = e.target.result.split("\n").slice(1);
        rows.forEach(row => {
          const [pair, date, h4, h1, zone, entry, sl, tp, result] = row.split(",");
          if (pair && date) {
            trades.push({ pair, date, h4, h1, zone, entry: +entry, sl: +sl, tp: +tp, result });
          }
        });
        localStorage.setItem("trades", JSON.stringify(trades));
        renderTable();
        generateStats();
      };
      reader.readAsText(file);
    }

    function generateStats() {
      const selectedPair = document.getElementById("statsPairSelect").value;
      const filtered = trades.filter(t => t.pair === selectedPair);
      const byMonth = {};
      filtered.forEach(t => {
        const month = t.date.slice(0, 7);
        if (!byMonth[month]) byMonth[month] = [];
        byMonth[month].push(t);
      });

      const statsDiv = document.getElementById("statsContainer");
      statsDiv.innerHTML = "";
      const labels = [], winCounts = [], lossCounts = [];

      Object.entries(byMonth).forEach(([month, arr]) => {
        const wins = arr.filter(a => a.result === "Win").length;
        const losses = arr.filter(a => a.result === "Loss").length;
        const avgRR = (arr.reduce((acc, t) => acc + (t.tp - t.entry) / (t.entry - t.sl), 0) / arr.length).toFixed(2);
        const bestDay = arr.map(a => new Date(a.date).getDay())
          .reduce((a, b, i, arr) => arr.filter(x => x === a).length >= arr.filter(x => x === b).length ? a : b);
        const dayMap = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
        statsDiv.innerHTML += `
          <div class="card">
            <strong>${month}</strong><br>
            Total Trades: ${arr.length}<br>
            Wins: ${wins}<br>
            Losses: ${losses}<br>
            Win Rate: ${(wins / arr.length * 100).toFixed(1)}%<br>
            Avg R:R: ${avgRR}<br>
            Best Day: ${dayMap[bestDay]}
          </div>
        `;
        labels.push(month);
        winCounts.push(wins);
        lossCounts.push(losses);
      });

      const ctx = document.getElementById('chartCanvas').getContext('2d');
      new Chart(ctx, {
        type: 'bar',
        data: {
          labels,
          datasets: [
            {
              label: 'Wins',
              data: winCounts,
              backgroundColor: 'rgba(75, 192, 192, 0.6)'
            },
            {
              label: 'Losses',
              data: lossCounts,
              backgroundColor: 'rgba(255, 99, 132, 0.6)'
            }
          ]
        }
      });
    }

    renderTable();
    generateStats();
  </script></body>
</html>
